import React, { useState, useEffect } from 'react';
import './VulnerabilityList.css'; // Assuming you will add some CSS for styling
import VulnerabilityCard from './VulnerabilityCard';

const VulnerabilityList = ({ vulnerabilities }) => {
  const [sortedVulnerabilities, setSortedVulnerabilities] = useState([]);
  const [sortOrder, setSortOrder] = useState('worst-to-best');

  useEffect(() => {
    sortVulnerabilities(sortOrder);
  }, [vulnerabilities, sortOrder]);

  const sortVulnerabilities = (order) => {
    const sorted = [...vulnerabilities].sort((a, b) => {
      const levels = { high: 3, medium: 2, low: 1 };
      return order === 'worst-to-best'
        ? levels[b.level] - levels[a.level]
        : levels[a.level] - levels[b.level];
    });
    setSortedVulnerabilities(sorted);
  };

  const handleSortOrderChange = (e) => {
    const order = e.target.value;
    setSortOrder(order);
    sortVulnerabilities(order);
  };

  return (
    <div className="vulnerability-list">
      <div className="sort-controls">
        <label htmlFor="sortOrder">Sort by: </label>
        <select id="sortOrder" value={sortOrder} onChange={handleSortOrderChange}>
          <option value="worst-to-best">Worst to Best</option>
          <option value="best-to-worst">Best to Worst</option>
        </select>
      </div>
      {sortedVulnerabilities
        .filter(vulnerability => vulnerability.title && vulnerability.description && vulnerability.level)
        .map((vulnerability, index) => (
          <VulnerabilityCard key={index} vulnerability={vulnerability} />
        ))}
    </div>
  );
};

export default VulnerabilityList;